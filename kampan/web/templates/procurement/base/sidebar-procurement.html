<div class="drawer-side shadow">
  <label for="drawer-menu" aria-label="close sidebar" class="drawer-overlay h-full"></label>
  <ul class="menu w-[280px] min-h-screen bg-base-100 gap-3 rounded-box">
    <div class="py-2 border-b mb-2">
      <h1 class="text-tns-black font-bold text-3xl text-center">DIIS INVENTORY</h1>
    </div>
    {% if organization %}
    {% if 'admin' in current_user.roles %}
    <li>
      <a class="{{ 'menu-active' if '/tor_years' in request.path else '' }}"
        href="{{ url_for('admin.tor_years.index', organization_id=organization.id) }}">
        <i class="ph ph-calendar"></i> ปีงบประมาณ
      </a>
    </li>
    {% endif %}
    {% if 'admin' in current_user.roles or 'staff' in current_user.roles %}
    <li>
      <details {% if '/procurement/products' in request.path or '/procurement/setting_email' in request.path %}open{%
        endif %}>
        <summary>
          <i class="ph ph-package"></i> ครุภัณฑ์
        </summary>
        <ul>
          <li style="padding-top: 0.5rem;">
            <details {% if '/procurement/requisitions' in request.path %}open{% endif %}>
              <summary>
                <i class="ph ph-scroll"></i>ขอซื้อขอจ้าง
              </summary>
              <ul>
                <li>
                  <a class="{{ 'menu-active' if '/procurement/requisitions' in request.path and '/renewal_requested' not in request.path else '' }}"
                    href="{{ url_for('procurement.requisitions.index', organization_id=organization.id ) }}">
                    <i class="ph ph-list"></i>รายการขอต่ออายุ
                  </a>
                </li>
                <li>
                  <a class="{{ 'menu-active' if '/procurement/requisitions/renewal_requested' in request.path else '' }}"
                    href="{{ url_for('procurement.requisitions.list_renewal_requested', organization_id=organization.id ) }}">
                    <i class="ph ph-arrow-clockwise"></i> รายการขอซื้อขอจ้าง
                  </a>
                </li>
                <li>
                  <a class="{{ 'menu-active' if '/procurement/requisitions/non-renewal' in request.path else '' }}"
                    href="{{ url_for('procurement.requisitions.list_non_renewal', organization_id=organization.id ) }}">
                    <i class="ph ph-x-circle"></i> รายการไม่ต่ออายุ
                  </a>
                </li>
              </ul>
            </details>
          </li>
          <li style="padding-top: 0.5rem;">
            <a class="{{ 'menu-active' if '/procurement/products' in request.path else '' }}"
              href="{{ url_for('procurement.products.index', organization_id=organization.id ) }}">
              <i class="ph ph-shopping-cart"></i> จัดการ MA
            </a>
          </li>
          {% if 'admin' in current_user.roles %}
          <li style="padding-top: 0.5rem;">
            <a class="{{ 'menu-active' if '/procurement/setting_email' in request.path else '' }}">
              <i class="ph ph-envelope-simple-open"></i>ตั้งค่าอีเมล
            </a>
          </li>
          {% endif %}
        </ul>
      </details>
    </li>
    {% if 'admin' in current_user.roles %}
    <li>
      <details {% if '/tor_years' in request.path or '/mas' in request.path %}open{% endif %}>
        <summary>
          <i class="ph ph-bank"></i> ระบบ MAS
        </summary>
        <ul>
          <li style="padding-top: 0.5rem;">
            <a class="{{ 'menu-active' if '/mas' in request.path else '' }}"
              href="{{ url_for('admin.mas.index', organization_id=organization.id) }}">
              <i class="ph ph-money-wavy"></i> แหล่งเงิน
            </a>
          </li>
        </ul>
      </details>
    </li>
    {% endif %}
    {% endif %}
    <li>
      <a class="{{ 'menu-active' if '/projects' in request.path else '' }}"
        href="https://apps.powerapps.com/play/e/default-8e634e67-9d66-46d2-a529-e1b708c5d8bc/a/8dcb79a0-0a96-47db-8859-88cf5ecf61c7?tenantId=8e634e67-9d66-46d2-a529-e1b708c5d8bc&hint=379da168-d429-436b-b398-7d5f35441630&sourcetime=1730427986026">
        <i class="ph ph-lightbulb"></i> Smart Office
      </a>
    </li>
    <li>
      <a class="{{ 'menu-active' if '/-----' in request.path else '' }}"
        href="{{ url_for('site.select_system', organization_id=organization.id) }}">
        <i class="ph ph-swap"></i> เปลี่ยนระบบ
      </a>
    </li>
    {% endif %}
    <div class="mt-auto p-3">
      <div class="flex items-center gap-3">
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium truncate">{{ current_user.get_resources_fullname_th() }}</p>
          <p class="text-xs text-base-content/60 truncate">{{ current_user.email }}</p>
        </div>
        <a class="font-bold hover:text-error py-3" href="{{ url_for('accounts.logout') }}">
          <i class="ph ph-size ph-sign-out"></i>
        </a>
      </div>
    </div>
  </ul>
</div>